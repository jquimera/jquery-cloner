!function(e,n){"use strict";var t={init:function(n,t){var o=this;return o.elem=t,o.$elem=e(o.elem),o.options=e.extend({},e.fn.cloner.options,n),o.$container=o.$elem,o.$clonables=o.$container.closestChild(o.options.clonable),o.$closeButton=o.$container.closestChild(o.options.closeButton),o.$clonables.addClass(o.options.sourceName),o.$closeButton.first().hide(),this.debug("--------------------------------"),this.debug("[Cloner]: initialized"),o},toggle:function(e,n){this.debug("start click--------------------------------");var t=n.$clonables,o=t.length,l=t.last(),a=l.clone(!0);l[0].hasAttribute("data-clone-number")||l.attr("data-clone-number",o);var r=l.data("clone-number");return a.removeClass(n.options.sourceName).addClass(n.options.cloneName),n.$last=l,n.$clone=a,n.cloneNumber=r,1==n.cloneNumber?this.cloneNumberHandler(n.cloneNumber,"increment",n):this.cloneNumberHandler(n.cloneNumber,"decrement",n),!(!n.options.limitCloneNumbers||!n.$clone.hasClass("clonable-clone-number-decrement")||1!==n.cloneNumber)||(n.debug("[Cloner]: start `beforeToggle` method"),n.options.beforeToggle(a,o,n),n.debug("[Cloner]: end `beforeToggle` method"),n.debug("[Cloner]: start `toggle` method"),n.options.clearValueOnClone&&(a.find("input, select").val(""),a.find("textarea").text("")),a.closestChild(n.options.closeButton).show(),this.increment(a,o,n),this.decrement(a,o,n),this.nestedClonesHandler(a,o,n),n.debug("[Cloner]: start clone append"),l.after(a),n.debug("[Cloner]: end clone append"),a.find(n.options.focusableElement).focus(),n.debug("[Cloner]: end `toggle` method"),n.debug("[Cloner]: start `afterToggle` method"),n.options.afterToggle(a,o,n),n.debug("[Cloner]: end `afterToggle` method"),this.debug("end click--------------------------------"),!0)},cloneNumberHandler:function(e,n,t){"increment"==n?t.$clone.attr("data-clone-number",e+1):"decrement"==n&&t.$clone.attr("data-clone-number",e-1)},increment:function(n,t,o){var l=this,a=n.find('[class*="'+o.options.incrementName+'"]').filter(function(t,l){return e(l).closest(o.options.clonable).get(0)==n.get(0)}),r=n[0].hasAttribute("clone-number")?n.data("clone-number"):t;l.debug("[Cloner]: start increment | Clone number: "+r+" | Index: "+t),a.each(function(){for(var n=e(this).attr("class").split(" "),t=n.length-1;t>=0;t--){var a=new RegExp(o.options.incrementName,"g");if(a.test(n[t])){var s=n[t].split(o.options.incrementName);switch(s=s[1].replace("-","")){case"value":var c=e(this).val(),i=+c.match(/\d/g).join("")+1;e(this).val(c.replace(/\d+/,i));break;case"html":var c=e(this).html(),i=+c.match(/\d/g).join("")+1;e(this).html(c.replace(/\d+/,i));break;case"text":var c=e(this).text(),i=+c.match(/\d/g).join("")+1;e(this).text(c.replace(/\d+/,i));break;case"for":case"id":case"class":default:var c=e(this).attr(s),i=+c.match(/\d/g).join("")+1;e(this).attr(s,c.replace(/\d+/,i))}}}l.debug("[Cloner]: incrementing values... | Clone Number: "+r)}),l.debug("[Cloner]: end increment ")},decrement:function(n,t,o){var l=this,a=n.find('[class*="'+o.options.decrementName+'"]').filter(function(t,l){return e(l).closest(o.options.clonable).get(0)==n.get(0)}),r=n[0].hasAttribute("clone-number")?n.data("clone-number"):t;l.debug("[Cloner]: start increment | Clone number: "+r+" | Index: "+t),a.each(function(){for(var n=e(this).attr("class").split(" "),t=n.length-1;t>=0;t--){var a=new RegExp(o.options.decrementName,"g");if(a.test(n[t])){var s=n[t].split(o.options.decrementName);switch(s=s[1].replace("-","")){case"value":var c=e(this).val(),i=+c.match(/\d/g).join("")-1;e(this).val(c.replace(/\d+/,i));break;case"html":var c=e(this).html(),i=+c.match(/\d/g).join("")-1;e(this).html(c.replace(/\d+/,i));break;case"text":var c=e(this).text(),i=+c.match(/\d/g).join("")-1;e(this).text(c.replace(/\d+/,i));break;case"for":case"id":case"class":default:var c=e(this).attr(s),i=+c.match(/\d/g).join("")-1;e(this).attr(s,c.replace(/\d+/,i))}}}l.debug("[Cloner]: incrementing values... | Clone Number: "+r)}),l.debug("[Cloner]: end increment ")},nestedClonesHandler:function(e,n,t){if(t.options.removeNestedClonablesOnClone){var o=e.closestChild(t.options.clonable);o.not("."+t.options.sourceName).remove()}return t},destroy:function(){this.destroy(),this.element.unbind(this.eventNamespace),this.bindings.unbind(this.eventNamespace)},remove:function(e){var n=this;return n.$clonables=n.$container.find(n.options.clonable),e(n),!0},debug:function(e){var n=this;n.options.debug&&console.log(e)}};e.fn.cloner=function(o){var l=Object.create(t);return this.each(function(){var t=l.init(o,this),a=t.$elem.closestChild(t.options.addButton);e(a).on("click",function(n){t.$clonables=e(this).closest(t.options.clonableContainer).closestChild(t.options.clonable),l.toggle(t.options,t),n.preventDefault()}),l.remove(function(t){return e(n).on("click",t.options.closeButton,function(n){e(this).closest(t.options.clonable).remove()}),!0})})},e.fn.closestChild=function(n){var t,o;return t=this.children(),0===t.length?e():(o=t.filter(n),o.length>0?o:t.closestChild(n))},e.fn.cloner.options={clonableContainer:".clonable-block",clonable:".clonable",addButton:".clonable-button-add",closeButton:".clonable-button-close",focusableElement:":input:visible:enabled:first",clearValueOnClone:!0,removeNestedClonablesOnClone:!0,limitCloneNumbers:!0,debug:!1,cloneName:"clonable-clone",sourceName:"clonable-source",incrementName:"clonable-increment",decrementName:"clonable-decrement",beforeToggle:function(e,n,t){},afterToggle:function(e,n,t){}},e(n).find("[data-toggle=cloner]").cloner()}(jQuery,document);